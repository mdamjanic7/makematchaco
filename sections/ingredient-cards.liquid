{% liquid
  assign heading = section.settings.heading
  assign subheading = section.settings.subheading
%}

<div class="section-background color-{{ section.settings.color_scheme }}"></div>

<ingredient-cards
  class="section section--full-width ingredient-cards color-{{ section.settings.color_scheme }} spacing-style"
  style="
    {%- render 'spacing-style', settings: section.settings %}
  "
>
  {% if heading != blank or subheading != blank %}
    <div class="ingredient-cards__header">
      {% if heading != blank %}
        <h2 class="ingredient-cards__heading">{{ heading | escape }}</h2>
      {% endif %}
      {% if subheading != blank %}
        <p class="ingredient-cards__subheading">{{ subheading | escape }}</p>
      {% endif %}
    </div>
  {% endif %}

  <div class="ingredient-cards__carousel">
    <div class="ingredient-cards__track" ref="track">
      {% content_for 'blocks' %}
    </div>

    <div class="ingredient-cards__arrows" ref="arrows">
      <button
        class="ingredient-cards__arrow ingredient-cards__arrow--prev"
        aria-label="{{ 'accessibility.slideshow_previous' | t }}"
        ref="prevBtn"
        on:click="/scrollPrev"
      >
        <span class="ingredient-cards__arrow-icon flip-x">
          {{- 'icon-arrow.svg' | inline_asset_content -}}
        </span>
      </button>
      <button
        class="ingredient-cards__arrow ingredient-cards__arrow--next"
        aria-label="{{ 'accessibility.slideshow_next' | t }}"
        ref="nextBtn"
        on:click="/scrollNext"
      >
        <span class="ingredient-cards__arrow-icon">
          {{- 'icon-arrow.svg' | inline_asset_content -}}
        </span>
      </button>
    </div>
  </div>
</ingredient-cards>

{% stylesheet %}
  .ingredient-cards {
    --ingredient-cards-margin: 16px;

    display: flex;
    flex-direction: column;
    gap: var(--gap-xl);
    overflow: clip;

    @media screen and (min-width: 750px) {
      --ingredient-cards-margin: 40px;
    }
  }

  .ingredient-cards__header {
    display: flex;
    flex-direction: column;
    gap: var(--gap-xs);
    padding-inline: var(--ingredient-cards-margin);
  }

  .ingredient-cards__heading {
    font-family: var(--font-heading--family);
    font-size: var(--font-size--h3);
    line-height: var(--line-height--heading-tight);
    letter-spacing: var(--letter-spacing--heading-tight);
    color: rgb(var(--color-foreground-heading));
    margin: 0;
  }

  .ingredient-cards__subheading {
    font-family: var(--font-body--family);
    font-size: var(--font-size--paragraph);
    line-height: var(--line-height--body-normal);
    color: var(--color-foreground);
    margin: 0;
  }

  .ingredient-cards__track {
    display: flex;
    gap: var(--gap-md);
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    scroll-padding-inline: var(--ingredient-cards-margin);
    scrollbar-width: none;
    padding-inline: var(--ingredient-cards-margin);
    padding-block-end: var(--padding-xs);
    cursor: grab;
    user-select: none;
    -webkit-user-select: none;

    @media screen and (min-width: 750px) {
      gap: var(--gap-lg);
    }
  }

  .ingredient-cards__track::-webkit-scrollbar {
    display: none;
  }

  /* Carousel container for arrow positioning */
  .ingredient-cards__carousel {
    position: relative;
  }

  .ingredient-cards__arrows {
    display: none;
    position: absolute;
    inset: 0;
    justify-content: space-between;
    align-items: center;
    padding-inline: var(--padding-xs);
    pointer-events: none;

    @media screen and (min-width: 750px) {
      display: flex;
    }
  }

  .ingredient-cards__carousel:hover .ingredient-cards__arrows,
  .ingredient-cards__carousel:focus-within .ingredient-cards__arrows {
    @media screen and (min-width: 750px) {
      display: flex;
    }
  }

  .ingredient-cards__arrow {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    border: none;
    border-radius: 50%;
    background: rgb(var(--color-foreground-heading-rgb, 210, 245, 0) / 0.9);
    color: rgb(var(--color-background-rgb));
    cursor: pointer;
    pointer-events: auto;
    opacity: 0;
    transition: opacity var(--animation-speed-fast) ease, transform var(--animation-speed-fast) ease;
  }

  .ingredient-cards__carousel:hover .ingredient-cards__arrow,
  .ingredient-cards__carousel:focus-within .ingredient-cards__arrow {
    opacity: 1;
  }

  .ingredient-cards__arrow:hover {
    transform: scale(1.1);
  }

  .ingredient-cards__arrow:focus-visible {
    outline: 2px solid var(--color-foreground);
    outline-offset: 2px;
    opacity: 1;
  }

  .ingredient-cards__arrow-icon {
    display: flex;
    width: 20px;
    height: 20px;
  }

  .ingredient-cards__arrow-icon svg {
    width: 100%;
    height: 100%;
  }

  @media (prefers-reduced-motion: reduce) {
    .ingredient-cards__arrow {
      transition: none;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "t:names.ingredient_cards",
  "disabled_on": {
    "groups": ["header"]
  },
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "t:settings.heading",
      "default": "What's in every cup"
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "t:settings.text",
      "default": "Calm energy. Sharper focus. Faster recovery. Here's what makes it work."
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:settings.color_scheme",
      "default": "scheme-8"
    },
    {
      "type": "header",
      "content": "t:content.padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "t:settings.top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 80
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "t:settings.bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 48
    }
  ],
  "blocks": [
    { "type": "ingredient-card" }
  ],
  "presets": [
    {
      "name": "t:names.ingredient_cards",
      "category": "t:categories.storytelling",
      "settings": {
        "heading": "What's in every cup",
        "subheading": "Calm energy. Sharper focus. Faster recovery. Here's what makes it work.",
        "color_scheme": "scheme-8",
        "padding-block-start": 80,
        "padding-block-end": 48
      },
      "blocks": {
        "l_theanine": {
          "type": "ingredient-card",
          "settings": {
            "label": "Amino Acid",
            "title": "L-Theanine",
            "description": "Calm, focused energy without the jitters. The reason matcha feels different from coffee."
          }
        },
        "egcg": {
          "type": "ingredient-card",
          "settings": {
            "label": "Potent Antioxidant",
            "title": "EGCG",
            "description": "Supports cellular health and natural metabolism. One of the most studied compounds in green tea."
          }
        },
        "catechins": {
          "type": "ingredient-card",
          "settings": {
            "label": "Antioxidant Compounds",
            "title": "Catechins",
            "description": "A family of natural compounds that support immune function and cardiovascular health."
          }
        },
        "polyphenols": {
          "type": "ingredient-card",
          "settings": {
            "label": "Plant Antioxidants",
            "title": "Polyphenols",
            "description": "Help protect against oxidative stress and support overall well-being."
          }
        },
        "chlorophyll": {
          "type": "ingredient-card",
          "settings": {
            "label": "Natural Detoxifier",
            "title": "Chlorophyll",
            "description": "Supports the body's natural recovery and helps reduce inflammation. What gives matcha its color."
          }
        },
        "vitamins": {
          "type": "ingredient-card",
          "settings": {
            "label": "Essential Vitamins",
            "title": "Vitamins C, A, K, B-Complex",
            "description": "A broad spectrum supporting immunity, vision, bone health, and sustained energy production."
          }
        },
        "minerals": {
          "type": "ingredient-card",
          "settings": {
            "label": "Key Minerals",
            "title": "Potassium, Magnesium, Zinc",
            "description": "Critical for muscle function, nerve signaling, and faster recovery after training."
          }
        }
      },
      "block_order": [
        "l_theanine",
        "egcg",
        "catechins",
        "polyphenols",
        "chlorophyll",
        "vitamins",
        "minerals"
      ]
    }
  ]
}
{% endschema %}
